#--------------------------------------------------------------------------------------------------------------------------------------------------
#   Part II: Multiple Regression
#   "Solution 8.5.3 Simulation.R"
#   Author: Marcel Steiner-Curtis
#   Date: 24.08.2018    sml
#--------------------------------------------------------------------------------------------------------------------------------------------------

rm(list=ls(all=TRUE))

#--------------------------------------------------------------------------------------------------------------------------------------------------
#   Solution 8.5.3 Simulation
#--------------------------------------------------------------------------------------------------------------------------------------------------
#   (a) Standard Normal Distribution
#--------------------------------------------------------------------------------------------------------------------------------------------------
n <- 100 # 10 20 50 100
set.seed(1)
for(i in 1:100){
    x <- rnorm(n, mean=0, sd=1)
    #   q-q plot
    qqnorm(x, pch=20, xlim=10*c(-1,1), ylim=10*c(-1,1), main="q-q plot: Standard Normal Distribution")
    qqline(x, col="red")
    grid()
    dev.flush()
    Sys.sleep(0.2)
}


#--------------------------------------------------------------------------------------------------------------------------------------------------
#   (b) Students t Distribution
#--------------------------------------------------------------------------------------------------------------------------------------------------
n <- 100 # 20 100
dfree <- 3 # 3 7 20
set.seed(1)
for(i in 1:100){
    x <- rt(n, df=dfree)
    #   q-q plot
    qqnorm(x, pch=20, xlim=10*c(-1,1), ylim=10*c(-1,1), main="q-q plot: Student's t Distribution")
    qqline(x, col="red")
    grid()
    dev.flush()
    Sys.sleep(0.2)
}


#--------------------------------------------------------------------------------------------------------------------------------------------------
#   (c) chi^2 Distribution
#--------------------------------------------------------------------------------------------------------------------------------------------------
n <- 100 # 20 100
dfree <- 1 # 1 20
set.seed(1)
for(i in 1:100){
    x <- rchisq(n, df=dfree)
    #   q-q plot
    qqnorm(x, pch=20, xlim=10*c(-1,1), ylim=10*c(-1,1), main="q-q plot: chi^2 Distribution")
    qqline(x, col="red")
    grid()
    dev.flush()
    Sys.sleep(0.2)
}


#--------------------------------------------------------------------------------------------------------------------------------------------------
